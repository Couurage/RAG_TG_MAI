# RAG-TG-MAI

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –≤–ø–µ—á–∞—Ç–ª—è—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞, –Ω–æ —É –Ω–∏—Ö –µ—Å—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∏–∑—ä—è–Ω:  
–º–æ–¥–µ–ª—å **–Ω–µ –∑–Ω–∞–µ—Ç —Ç–æ–≥–æ, —á–µ–≥–æ –Ω–µ –≤–∏–¥–µ–ª–∞ –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏** –∏ –ª–µ–≥–∫–æ –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç—ã.  
–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ ‚Äî –ª–µ–∫—Ü–∏—è–º–∏, –º–µ—Ç–æ–¥–∏—á–∫–∞–º–∏, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ ‚Äî –æ–±—ã—á–Ω–∞—è LLM –Ω–µ–ø—Ä–∏–≥–æ–¥–Ω–∞.  

–ó–¥–µ—Å—å –ø–æ—è–≤–ª—è–µ—Ç—Å—è **RAG (Retrieval-Augmented Generation)** ‚Äî –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –¥–≤—É—Ö –º–∏—Ä–æ–≤:  
1) —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–∞–∑–µ,  
2) –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ—Ç–≤–µ—Ç–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–∫—Ç–æ–≤.

RAG –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –Ω–µ "—É–≥–∞–¥—ã–≤–∞—Ç—å", –∞ –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.  
–¢—ã –∑–∞–¥–∞—ë—à—å –≤–æ–ø—Ä–æ—Å ‚Üí —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –Ω—É–∂–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–µ ‚Üí —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Üí LLM —Å–æ–∑–¥–∞—ë—Ç —Ç–æ—á–Ω—ã–π, –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç.

**RAG_TG_MAI** ‚Äî —ç—Ç–æ –ø—Ä–æ–µ–∫—Ç –ø–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é —Ç–∞–∫–æ–π —Å–∏—Å—Ç–µ–º—ã.  
–í –Ω—ë–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:  
- –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤, –ª–µ–∫—Ü–∏–π, –º–µ—Ç–æ–¥–∏—á–µ–∫),  
- –Ω–∞—Ä–µ–∑–∫–∞ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —á–∞–Ω–∫–∏,  
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —á–µ—Ä–µ–∑ Gemma,  
- —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Ö –≤ Milvus,  
- –ø–æ–∏—Å–∫ –ø–æ –∑–∞–ø—Ä–æ—Å—É,  
- (–ø–æ–∑–∂–µ) —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ LLM –∏ Telegram-–±–æ—Ç.

–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–ª—å ‚Äî —Å–æ–∑–¥–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π "—á–∏—Ç–∞–µ—Ç" —Ç–≤–æ–∏ —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫–∞–∫ —É–º–Ω—ã–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä: –∞–∫–∫—É—Ä–∞—Ç–Ω–æ, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É, –∫–æ—Ç–æ—Ä—ã–π –µ–º—É —Ä–µ–∞–ª—å–Ω–æ –¥–∞–ª–∏.

---

# üìö RAG_TG_MAI

RAG_TG_MAI ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–ª—è RAG-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞: —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–∏—Å–∫ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤.  
–ü—Ä–æ–µ–∫—Ç —É–∂–µ –≤–∫–ª—é—á–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–∏–∑–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è ‚Äî –º–æ–¥–µ–ª—å, —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é, —ç–º–±–µ–¥–¥–∏–Ω–≥–∏, Milvus, —Ç–µ—Å—Ç–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω ‚Äî –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é –≤ Telegram-–±–æ—Ç–∞.

---

## üîé –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –∏ —á–∞–Ω–∫–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞ (`backend/gemma_services/tokenizer.py`)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ Gemma-–º–æ–¥–µ–ª—å—é (`backend/gemma_services/embedder.py`)
- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ (`backend/models/gemma.py`)
- –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Milvus (—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏, –≤—Å—Ç–∞–≤–∫–∞, –ø–æ–∏—Å–∫)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –º–æ–¥—É–ª—å (`config.py`)
- Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è Milvus Standalone (`docker-compose.yml`)
- –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤—Å—Ç–∞–≤–∫–∏/–ø–æ–∏—Å–∫–∞ (`main.py`)

–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM (–ø–æ–ª–Ω—ã–π RAG-–æ—Ç–≤–µ—Ç),
- —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Telegram-–±–æ—Ç–∞,
- –∑–∞–≥—Ä—É–∑–∫–∞ —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –±–æ–ª—å—à–∏–º–∏ –ø–∞—Ä—Ç–∏—è–º–∏.

---

## üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Python 3.12**, **PyTorch**, **HuggingFace Transformers**,  
**Milvus**, **pymilvus**, **Docker**,  
(–±—É–¥—É—â–µ–µ: **aiogram**, –ª—é–±–∞—è LLM-–º–æ–¥–µ–ª—å)

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
RAG_TG_MAI/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ gemma_services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tokenizer.py     # –†–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ embedder.py      # –≠–º–±–µ–¥–¥–∏–Ω–≥–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gemma.py         # –õ–µ–Ω–∏–≤—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏ Gemma
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ milvus.py        # –†–∞–±–æ—Ç–∞ —Å –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π Milvus
‚îÇ
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/Couurage/RAG_TG_MAI.git
cd RAG_TG_MAI

python -m venv .venv
source .venv/bin/activate      # Windows: .venv\Scripts\activate
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ Milvus

```bash
docker-compose up -d
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í —Ñ–∞–π–ª–µ `config.py` –∑–∞–¥–∞—é—Ç—Å—è —Ö–æ—Å—Ç Milvus, –ø–æ—Ä—Ç, –∏–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏.

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```bash
python main.py
```

---

## üê≥ –ó–∞–ø—É—Å–∫ –≤ Docker

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —É–∂–µ –µ—Å—Ç—å `Dockerfile` –∏ `docker-compose.yml`, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–Ω–∏–º–∞—é—Ç Milvus Standalone –∏ FastAPI-API.

1. –ü–æ–¥–≥–æ—Ç–æ–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   cp .env.example .env  # –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞–π –≤—Ä—É—á–Ω—É—é –ø–æ config.py
   # –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–ø–∏—à–∏ GIGACHAT_* –∏ —Ç–æ–∫–µ–Ω—ã
   ```
   –î–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ API —Ö–æ—Å—Ç Milvus –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (`MILVUS_HOST=standalone`), –Ω–æ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ `.env`.

2. –°–æ–∑–¥–∞–π –∫–∞—Ç–∞–ª–æ–≥–∏ –¥–ª—è –æ–±—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö:
   ```bash
   mkdir -p data_md volumes/hf_cache
   ```
   `data_md` ‚Äî —Ö—Ä–∞–Ω–∏—Ç markdown-–≤–µ—Ä—Å–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, `volumes/hf_cache` ‚Äî –∫—ç—à HuggingFace, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –Ω–µ —Å–∫–∞—á–∏–≤–∞–ª–∞—Å—å –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ.

3. –°–æ–±–µ—Ä–∏ –∏ –ø–æ–¥–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å—ã:
   ```bash
   docker compose up -d --build
   ```
   –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –∑–∞–π–º—ë—Ç –≤—Ä–µ–º—è ‚Äî Docker —Å–∫–∞—á–∞–µ—Ç Milvus, –∞ FastAPI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç—è–Ω–µ—Ç –≤–µ—Å–∞ Gemma.

4. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤—Å—ë –∂–∏–≤–æ:
   ```bash
   docker compose ps
   curl http://localhost:8000/health
   ```

5. –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
   - –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ñ–∞–π–ª–∞:
     ```bash
     curl -X POST "http://localhost:8000/index" \
       -F "section=lectures" \
       -F "file=@book2013-2.docx"
     ```
   - –í–æ–ø—Ä–æ—Å –ø–æ –≤—Å–µ–º—É –∫–æ—Ä–ø—É—Å—É:
     ```bash
     curl -X POST "http://localhost:8000/query" \
       -H "Content-Type: application/json" \
       -d '{"question":"–ß—Ç–æ —Ç–∞–∫–æ–µ Milvus?","top_k":5}'
     ```
   - –ü–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ (–∏—Å–ø–æ–ª—å–∑—É–π `doc_id` –∏–∑ /index):
     ```bash
     curl -X POST "http://localhost:8000/query" \
       -H "Content-Type: application/json" \
       -d '{"question":"–§–æ—Ä–º—É–ª–∞ ...","top_k":5,"doc_id":123456}'
     ```
   - –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞:
     ```bash
     curl -X DELETE "http://localhost:8000/documents?doc_id=123456"
     ```

Log-—Å–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞–∫: `docker compose logs -f rag_api`.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã Telegram-–±–æ—Ç –∫—Ä—É—Ç–∏–ª—Å—è –≤ —Ç–æ–º –∂–µ `docker-compose`, —É–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ `.env` –∑–∞–¥–∞–Ω `TELEGRAM_BOT_TOKEN`, –ø–æ—Ç–æ–º:

```bash
docker compose up -d rag_api rag_bot
docker compose logs -f rag_bot    # –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–±—ã—Ç–∏—è aiogram
```

–î–ª—è –±–æ—Ç–∞ –∞–¥—Ä–µ—Å API –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (`RAG_API_BASE=http://rag_api:8000`).

---

## ü§ñ Telegram-–±–æ—Ç –Ω–∞ aiogram

–í –∫–∞—Ç–∞–ª–æ–≥–µ `bot/` –ª–µ–∂–∏—Ç –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ aiogram 3, –∫–æ—Ç–æ—Ä—ã–π –æ–±—â–∞–µ—Ç—Å—è —Å FastAPI.

1. –ü—Ä–æ–ø–∏—à–∏ –≤ `.env` —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:
   ```
   TELEGRAM_BOT_TOKEN=...
   RAG_API_BASE=http://localhost:8000  # –∏–ª–∏ –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   ```
2. –£–±–µ–¥–∏—Å—å, —á—Ç–æ API —É–∂–µ –∑–∞–ø—É—â–µ–Ω–æ (–ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ —á–µ—Ä–µ–∑ Docker) –∏ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ `RAG_API_BASE`.
3. –ê–∫—Ç–∏–≤–∏—Ä—É–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ —Å—Ç–∞—Ä—Ç—É–π:
   ```bash
   python -m bot.main
   ```

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –≤ Docker (—Å–º. —Ä–∞–∑–¥–µ–ª ¬´–ó–∞–ø—É—Å–∫ –≤ Docker¬ª –≤—ã—à–µ): `docker compose up -d rag_bot`.

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–æ—Ç–∞:
- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏.
- `/reset` ‚Äî —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É.
- –õ—é–±–æ–π —Ç–µ–∫—Å—Ç ‚Äî –∑–∞–ø—Ä–æ—Å –∫ `/query` (–µ—Å–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω —Ñ–∞–π–ª, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç `doc_id` –∏ –∏—â–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –Ω—ë–º).
- –õ—é–±–æ–π –¥–æ–∫—É–º–µ–Ω—Ç (PDF/DOCX/MD) ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ `/index`, –≤ –æ—Ç–≤–µ—Ç –±–æ—Ç –ø—Ä–∏—Å—ã–ª–∞–µ—Ç `doc_id` –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤.

---

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ (–∫–æ—Ä–æ—Ç–∫–æ)

1. –î–æ–∫—É–º–µ–Ω—Ç —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–º—ã—Å–ª–æ–≤—ã–µ —á–∞–Ω–∫–∏.  
2. –ö–∞–∂–¥—ã–π —á–∞–Ω–∫ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥ (–≤–µ–∫—Ç–æ—Ä).  
3. –í–µ–∫—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ Milvus ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.  
4. –ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–∂–µ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥.  
5. Milvus –∏—â–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –±–ª–∏–∑–∫–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã.  
6. (–ø–æ–∑–∂–µ) LLM —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–¥–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç —Ä–æ–≤–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –µ–π –¥–∞–ª–∏, –±–µ–∑ ‚Äú–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π‚Äù.

---

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from pymilvus import connections, utility
from backend.database.milvus import Milvus
from backend.gemma_services.embedder import Embedder
from backend.gemma_services.tokenizer import Tokenizer

milvus = Milvus()
tokenizer = Tokenizer()
embedder = Embedder()

connections.connect(
    "default",
    host=milvus.host,
    port=milvus.port,
)

print("–ö–æ–ª–ª–µ–∫—Ü–∏–∏:", utility.list_collections(using=milvus.alias))
print("–¢–µ–∫—É—â–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è:", milvus.collection.name)

coll = milvus.collection
coll.load()

text = "–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –ø—Ä–æ Milvus, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å—Ç–∞–≤–∫—É."
tokens = tokenizer.chunk_markdown(text)
embedding = embedder.embed(tokens)

coll.add_chunks(
    chunk_id=0,
    section="intro",
    source_path="test.md",
    doc_id=1,
    embedding=embedding,
)
```

---

## üó∫ Roadmap

- —É–ª—É—á—à–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏ Milvus,  
- –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ LLM –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ RAG-–æ—Ç–≤–µ—Ç–∞,  
- Telegram-–±–æ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç,  
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ª–µ–∫—Ü–∏–π –∏ PDF,  
- —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –≤—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞.

---

## üë§ –ê–≤—Ç–æ—Ä

**Alexander Malakhov (Couurage)**  
GitHub: https://github.com/Couurage

---

–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω—Ä–∞–≤–∏—Ç—Å—è ‚Äî ‚≠ê –≤—Å–µ–≥–¥–∞ –ø–æ–º–æ–∂–µ—Ç –µ–º—É —Ä–∞—Å—Ç–∏.
